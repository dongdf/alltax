webpackJsonp([51],{"8T+I":function(module,__webpack_exports__,__webpack_require__){"use strict";(function($){var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__=__webpack_require__("mvHQ"),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise__=__webpack_require__("//Fk"),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise__),__WEBPACK_IMPORTED_MODULE_2__components_pay__=__webpack_require__("mTUd"),__WEBPACK_IMPORTED_MODULE_3__components_toastOne__=__webpack_require__("lgrl"),__WEBPACK_IMPORTED_MODULE_4__components_expertCard__=__webpack_require__("j+K+"),__WEBPACK_IMPORTED_MODULE_5__components_recommends__=__webpack_require__("k1Tv"),__WEBPACK_IMPORTED_MODULE_6__components_sendComments__=__webpack_require__("XTYa"),__WEBPACK_IMPORTED_MODULE_7__components_comments__=__webpack_require__("6rV5"),__WEBPACK_IMPORTED_MODULE_8__components_reply__=__webpack_require__("Wkgs"),__WEBPACK_IMPORTED_MODULE_9__components_submitStar__=__webpack_require__("k26J"),__WEBPACK_IMPORTED_MODULE_10__coupon__=__webpack_require__("B4FG"),__WEBPACK_IMPORTED_MODULE_11__components_experts__=__webpack_require__("CB57"),__WEBPACK_IMPORTED_MODULE_12__components_noresult__=__webpack_require__("oPJ/");__webpack_exports__.a={data:function(){return{pinfo:{},spic:!1,isableZhe:!0,morezhe:!1,totalMoney:0,chooseMoney:0,chooseCourse:!1,huiMoney:100,agenweb:null,touchnumb:0,paycomm:[],audioPlay:null,isBuy:!1,startShow:!1,active:0,videoBuytip:!1,courseInfo:"",clicked:!1,videoSrc:"",commentList:{},discussList:{},expertId:"",videoId:"",expertInfo:{},attented:!0,islike:!0,audioShow:!0,payShow:!1,selectQquan:!1,konwlege:[],cuuiculu:[],goods:[],courseId:"",experts:[],commentPnumb:1,commentPsize:15,commentsMore:!0,commentQesPnumb:1,commentQesPsize:15,commentsQesMore:!0,vList:[],selectVideo:{id:""},playVideo:null,isShowVip:!1,isVip:null,hisPlay:null,siglVideoUrl:"",mineInfo:{},pytpe:!1,buyInfo:{buyTitle:"订单金额",isCoupon:!0,type:"3",info:{money:"11980"},wxPay:!0,memberPay:!0},parentShowpay:!1,relInfo:{name:"课程",title:"122"},aliplayer:null,qqplayer:null}},filters:{},components:{noresult:__WEBPACK_IMPORTED_MODULE_12__components_noresult__.a,submitStar:__WEBPACK_IMPORTED_MODULE_9__components_submitStar__.a,toastOne:__WEBPACK_IMPORTED_MODULE_3__components_toastOne__.a,comments:__WEBPACK_IMPORTED_MODULE_7__components_comments__.a,SendComments:__WEBPACK_IMPORTED_MODULE_6__components_sendComments__.a,recommends:__WEBPACK_IMPORTED_MODULE_5__components_recommends__.a,reply:__WEBPACK_IMPORTED_MODULE_8__components_reply__.a,expertCard:__WEBPACK_IMPORTED_MODULE_4__components_expertCard__.a,Coupu:__WEBPACK_IMPORTED_MODULE_10__coupon__.a,experts:__WEBPACK_IMPORTED_MODULE_11__components_experts__.a},computed:{},methods:{creatQQ:function(){return new __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default.a(function(t,e){$.getScript("//imgcache.qq.com/open/qcloud/video/tcplayer/tcplayer.min.js",function(){t()})})},qqPlay:function(){var t=this,e=this;this.$http.post("curriculum/curriculumService/getPlayCommenAuth",{subData:this.$route.query.id}).then(function(i){if(1==i.data.code){if(t.pinfo=i.data.data,!i.data.data.videoId)return t.$toast("该课程无法试看，请购买后观看"),!1;var o={controls:!0,autoplay:!0,fileID:i.data.data.videoId,appID:i.data.data.appid,t:i.data.data.t,us:i.data.data.us,sign:i.data.data.sign,plugins:{ContinuePlay:{auto:!0,text:"上次播放至 ",btnText:"恢复播放"}}};i.data.data.exper&&(o.exper=i.data.data.exper),e.creatQQ().then(function(t){e.qqplayer=TCPlayer("player-container-id",o)})}else t.$toast(i.data.msg)})},aliPlay:function(){var t=this,e=this;this.$http.post("curriculum/curriculumService/getPlayQqAuth",{subData:this.$route.query.id}).then(function(i){1==i.data.code?(e.aliplayer=new Aliplayer({id:"J_prismPlayer",width:"100%",vid:i.data.data.videoId,playauth:i.data.data.playAuthCode,playsinline:!0,cover:e.courseInfo.coverUrl,autoplay:!1,preload:!1,x5_type:"h5",language:"zh-cn"},function(t){console.log("播放器创建好了。"),e.spic=!0}),e.aliplayer.on("ended",function(){e.listenVideoEnd(),console.log("播放完毕")}),t.aliplayer.tag.addEventListener("x5videoexitfullscreen",function(){WeixinJSBridge})):e.$toast(i.data.msg)})},aliPlayXin:function(){var t=this,e=this;this.getmyinfo().then(function(i){if(!i.mobile)return t.$messagebox.confirm("请先完善用户信息","提示",{confirmButtonText:"确定"}).then(function(e){t.$router.push("/login")}),!1;t.$http.post("curriculum/curriculumService/play",{subData:{videoId:t.courseInfo.id}}).then(function(i){if(1==i.data.code){if(!i.data.data.curriculumUrl)return t.$toast("该课程无法试看，请购买后观看"),!1;e.aliplayer=new Aliplayer({id:"J_prismPlayer",width:"100%",controlBarVisibility:"always",source:i.data.data.curriculumUrl,playsinline:!0,cover:e.courseInfo.coverUrl,autoplay:!1,preload:!1,x5_type:"h5",language:"zh-cn"},function(t){console.log("播放器创建好了。"),e.spic=!0}),e.aliplayer.on("ended",function(){e.listenVideoEnd(),console.log("播放完毕")});var o=i.data.data.curriculumUrl;".mp3"==o.substr(o.lastIndexOf(".")).toLowerCase()&&(e.pytpe=!0)}else t.$toast(i.data.msg),t.clicked=!1})})},smallzhe:function(){var t=this;if(this.morezhe){var e=this.vList.findIndex(function(e){return e.id==t.courseId});for(var i in++e<3&&(e=3),this.vList)this.vList[i].zshow=i<e}else for(var i in this.vList)this.$set(this.vList[i],"zshow",!0);this.morezhe=!this.morezhe},wxgoumais:function(t){var e;this.chooseCourse=!1,1==t&&(e={buyTitle:"订单金额",isCoupon:!0,type:"3",info:{money:1==this.isShowVip.user_type?this.courseInfo.vipPrice:this.courseInfo.curriculumPrice,resourceId:this.courseId},wxPay:!0,memberPay:!1}),2==t&&(e={buyTitle:"订单金额",isCoupon:!0,type:"3",info:{money:1==this.isShowVip.user_type?this.courseInfo.pVipPrice:this.courseInfo.pPrice,resourceId:this.courseInfo.pid},wxPay:!0,memberPay:!1}),this.paycomm=[],this.paycomm.push({component:__WEBPACK_IMPORTED_MODULE_2__components_pay__.a,parentShowpay:!0,buyInfo:e})},closebuy:function(){this.chooseCourse=!1},youhuiMoney:function(){var t=0;for(var e in this.vList)t+=this.vList[e].vipPrice;for(var e in this.huiMoney=t-this.totalMoney,this.chooseMoney=0,this.vList)this.vList[e].bcked&&(this.chooseMoney+=this.vList[e].vipPrice)},buyck:function(t){var e=this.vList.findIndex(function(e){return t.id==e.id});t.bcked?this.$set(this.vList[e],"bcked",!1):this.$set(this.vList[e],"bcked",!0)},toPayinfo:function(){this.buyInfo={buyTitle:"订单金额",isCoupon:!0,type:"3",info:{money:1==this.isShowVip.user_type?this.courseInfo.vipPrice:this.courseInfo.curriculumPrice,resourceId:this.courseId},wxPay:!0,memberPay:!1}},tipsBuys:function(){this.videoBuytip=!1,this.toPayinfo(),this.parentShowpay=!0,this.wxbuy()},tipsBuysClose:function(){this.videoBuytip=!1},payClose:function(){this.paycomm[0].parentShowpay=!1,this.paycomm=[]},wxbuy:function(){var t=this;this.$http.get("user/userService/getUserWeChatVo").then(function(e){if(!e.data.data.mobile)return t.$messagebox.confirm("请先完善用户信息","提示",{confirmButtonText:"确定"}).then(function(e){t.$router.push("/login")}),!1;t.courseInfo.pid?(t.chooseCourse=!0,t.youhuiMoney()):(t.toPayinfo(),t.paycomm.push({component:__WEBPACK_IMPORTED_MODULE_2__components_pay__.a,parentShowpay:!0,buyInfo:t.buyInfo}))})},tab:function(t){1==t&&(this.discussList=[],this.commentQesPnumb=1,this.commentsMore=!0,this.getcommentsQuestion()),2==t&&(this.commentList=[],this.commentPnumb=1,this.commentsQesMore=!0,this.getcomments()),this.active=t},createVideo:function(){document.body.clientWidth;var t=document.getElementById("neplayer");t.innerHTML="",t.innerHTML='<video id="my-video" x5-playsinline  playsinline="" webkit-playsinline="" autoplay class="" controls  width="100%"   data-setup=\'{}\'></video>',this.playVideo=document.getElementById("my-video")},creatAudio:function(){var t=document.getElementById("audioContent"),e=document.createElement("AUDIO");e.setAttribute("id","my-audio"),e.setAttribute("controls","controls"),e.setAttribute("controlsList","nodownload"),e.style.width="100%",this.audioPlay||t.appendChild(e),this.audioShow=!1,this.audioPlay=document.getElementById("my-audio")},listenVideoEnd:function(){var t=this;1==this.courseInfo.source?this.playVideo.addEventListener("ended",function(){!t.isBuy&&t.courseInfo.vipPrice&&(t.videoBuytip=!0)}):!t.isBuy&&t.courseInfo.vipPrice&&(t.videoBuytip=!0)},listenAudioEnd:function(){var t=this;this.audioPlay.addEventListener("ended",function(){!t.isBuy&&t.courseInfo.vipPrice&&(t.videoBuytip=!0)})},getmyinfo:function(){var t=this;return new __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default.a(function(e,i){t.$http.get("user/userService/getUserWeChatVo").then(function(t){e(t.data.data)})})},mostart:function(){this.playClick(),this.touchnumb++},moend:function(){var t=this,e=this;setTimeout(function(){t.playVideo?(e.playVideo.play(),e.listenVideoEnd()):e.audioPlay.play()},1e3),this.touchnumb++},moliststart:function(t){this.playV(t)},molistend:function(t){var e=this;setTimeout(function(){e.playVideo?(e.playVideo.play(),e.listenVideoEnd()):e.audioPlay.play()},1e3)},newplay:function(){},playClick:function playClick(){var _this8=this,that=this;this.getmyinfo().then(function(data){if(!data.mobile)return _this8.$messagebox.confirm("请先完善用户信息","提示",{confirmButtonText:"确定"}).then(function(t){_this8.$router.push("/login")}),!1;_this8.$http.post("curriculum/curriculumService/play",{subData:{videoId:_this8.courseInfo.id}}).then(function(res){if(1==res.data.code){if(!res.data.data.curriculumUrl)return _this8.$toast("该课程无法试看，请购买后观看"),!1;var obj=res.data.data.curriculumUrl,suffix=obj.substr(obj.lastIndexOf(".")).toLowerCase();if(".mp3"==suffix)_this8.creatAudio(),_this8.audioPlay.src=res.data.data.curriculumUrl,_this8.audioPlay.play(),_this8.listenAudioEnd();else{if(_this8.clicked=!0,_this8.createVideo(),_this8.courseInfo.isSerial?res.data.data.isBuy?(_this8.selectVideo=that.vList[0],_this8.playVideo.src=res.data.data.curriculumUrl):(_this8.selectVideo={},_this8.siglVideoUrl=res.data.data.curriculumUrl,_this8.playVideo.src=res.data.data.curriculumUrl):_this8.playVideo.src=res.data.data.curriculumUrl,localStorage.getItem("play")){var localPlay=eval("("+localStorage.getItem("play")+")"),idx=localPlay.findIndex(function(t){return t.courseId==that.courseInfo.id});idx>=0&&(_this8.playVideo.currentTime=localPlay[idx].currentPlay)}_this8.playVideo.play(),_this8.listenVideoEnd()}}else _this8.$toast(res.data.msg),_this8.clicked=!1})})},playV:function(t){return this.$router.replace({path:"/course-detail",query:{id:t.id}}),!1},attent:function(){var t=this;this.$http.post("curriculum/curriculumService/attent/add",{subData:{videoId:this.courseId}}).then(function(e){1==e.data.code&&(t.islike=!0,t.courseInfo.attentTotal++),console.log(e.data)})},cancelAttent:function(){var t=this;this.$http.post("curriculum/curriculumService/attent/delete",{subData:{videoId:this.courseId}}).then(function(e){if(t.islike=!1,0==t.courseInfo.attentTotal)return!1;t.courseInfo.attentTotal--})},getkonwlege:function(){var t=this;this.$http.post("curriculum/curriculumService/relKnowledge",{subData:{resourceId:this.courseId,pageSize:5,pageNum:1}}).then(function(e){t.konwlege=e.data.data.list})},getcuuiculu:function(){var t=this;this.$http.post("curriculum/curriculumService/relExpert",{subData:{resourceId:this.courseId,pageSize:5,pageNum:1}}).then(function(e){t.cuuiculu=e.data.data.list})},getgoods:function(){var t=this;this.$http.post("curriculum/curriculumService/relGoods",{subData:{resourceId:this.courseId,pageSize:5,pageNum:1}}).then(function(e){t.goods=e.data.data.list})},getcoursedetail:function(){var t=this;this.$http.post("curriculum/curriculumService/getPlayCommenAuth",{subData:this.$route.query.id}).then(function(e){1!=e.data.code&&t.$router.replace({path:"/noresource"}),1==e.data.code?(t.courseInfo=e.data.data,1==t.courseInfo.key?(t.createVideo(),t.playVideo.src=t.courseInfo.videoId,t.playVideo.play()):t.qqPlay()):console.log(e.data.msg)})},getexperts:function(){var t=this;this.$http.post("curriculum/curriculumService/relExpert",{subData:{resourceId:this.courseId,pageSize:5,pageNum:1}}).then(function(e){t.experts=e.data.data.list})},getcomments:function(){var t=this,e=this;this.$http.post("curriculum/curriculumService/criticism/list",{subData:{pageNum:this.commentPnumb,pageSize:this.commentPsize,videoId:this.courseId}}).then(function(i){if(0==i.data.data.list.length)return t.pnumb>1&&t.$toast("没有了"),t.commentsMore=!1,!1;if(t.commentList.length>0){var o=i.data.data.list;for(var s in o)e.commentList.push(o[s])}else t.commentList=i.data.data.list})},commentsLoadmore:function(){this.commentPnumb++,this.getcomments()},addcomments:function(){this.$http.post("curriculum/curriculumService/chat/add",{subData:{videoId:this.courseId,content:"wwwwwwwwwwwwwwwww"}}).then(function(t){t.data.code,console.log(t.data)})},commentsQesLoadmore:function(){this.commentQesPnumb++,this.getcommentsQuestion()},getcommentsQuestion:function(){var t=this,e=this;this.$http.post("curriculum/curriculumService/chat/list",{subData:{pageNum:this.commentQesPnumb,pageSize:this.commentQesPsize,videoId:this.courseId}}).then(function(i){if(0==i.data.data.list.length)return t.pnumb>1&&t.$toast("没有了"),t.commentsQesMore=!1,!1;if(t.discussList.length>0){var o=i.data.data.list;for(var s in o)e.discussList.push(o[s])}else t.discussList=i.data.data.list})},getVideoList:function(t){var e=this,i=this;this.$http.post("curriculum/curriculumService/curriculumSerial",{subData:{videoId:t}}).then(function(t){e.vList=t.data.data;var o=e.vList.findIndex(function(t){return t.id==i.courseId});for(var s in++o<3&&(o=3),e.vList.length==o&&(e.isableZhe=!1),e.vList)e.vList[s].id==e.courseId?(e.$set(e.vList[s],"isshow",!0),e.$set(e.vList[s],"bcked",!0)):e.$set(e.vList[s],"isshow",!1),s<o?e.$set(e.vList[s],"zshow",!0):e.$set(e.vList[s],"zshow",!1)})},getisVip:function(){var t=this;this.$http.get("user/userService/getUserWeChatVo").then(function(e){t.isShowVip=e.data.data})},getisBuy:function(){},getcurrentPlay:function getcurrentPlay(){var _this20=this,tarray=localStorage.getItem("play")?eval("("+localStorage.getItem("play")+")"):[],idx=tarray.findIndex(function(t){return t.courseId==_this20.courseId});idx>=0&&(this.hisPlay=tarray[idx],console.log(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(this.hisPlay)))}},destroyed:function destroyed(){if(this.qqplayer&&(this.qqplayer=null),this.playVideo){var tarray=localStorage.getItem("play")?eval("("+localStorage.getItem("play")+")"):[],cur=void 0;cur={courseId:this.courseId,currseInfo:"",currentPlay:this.playVideo.currentTime.toFixed(1)};var idx=tarray.findIndex(function(t){return t.courseId==cur.courseId});if(idx<0)tarray.push(cur);else for(var i in tarray)cur.courseId==tarray[i].courseId&&(tarray[i]=cur);localStorage.setItem("play",__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(tarray)),this.playVideo=null,this.audioPlay=null}},mounted:function(){this.agenweb=/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent),this.courseId=this.$route.query.id,this.getcoursedetail()}}}).call(__webpack_exports__,__webpack_require__("7t+N"))},Oepu:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i("8T+I"),s={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{attrs:{id:"course-detail"}},[i("div",{attrs:{id:"qqvideo"}},[2!=t.courseInfo.source||t.pinfo.videoId?t._e():i("img",{attrs:{src:t.courseInfo.coverUrl}})]),t._v(" "),2==t.courseInfo.key?i("video",{attrs:{id:"player-container-id",preload:"auto","x5-playsinline":"",playsinline:"","webkit-playsinline":""}}):t._e(),t._v(" "),i("div",{staticClass:"neplayercontent",attrs:{id:"neplayer"}})])])},staticRenderFns:[]};var a=function(t){i("XA6B")},n=i("VU/8")(o.a,s,!1,a,"data-v-1fec5769",null);e.default=n.exports},XA6B:function(t,e){}});